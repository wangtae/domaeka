# 지점 서브관리자 권한 테스트 시나리오

## 테스트 개요
- **테스트 대상**: 지점 서브관리자
- **테스트 목적**: 지점 서브관리자의 제한된 권한 동작 검증
- **상위 계층**: 특정 지점 소속

## 사전 조건
- 지점 최고관리자 계정이 생성되어 있어야 함 (예: b_test_01)
- 지점 서브관리자 계정이 생성되어 있어야 함 (예: b_staff_sub_01)
- g5_auth 테이블에 서브관리자 권한이 설정되어 있어야 함

## 테스트 시나리오

### 1. 서브관리자 계정 생성 및 권한 부여

#### 1.1 지점 최고관리자로 서브관리자 생성
1. 지점 최고관리자(b_test_01)로 로그인
2. [관리자 관리] > "서브관리자 관리" 메뉴 접속
3. "+ 서브관리자 등록" 버튼 클릭
4. 서브관리자 정보 입력:
   - 관리자 ID: `b_staff_sub_01`
   - 비밀번호: `b_staff_sub_01`
   - 이름: `지점직원`
   - 이메일: `b_staff_sub_01@gmail.com`
5. 권한 설정:
   - ✓ 주문 조회
   - ✓ 주문 상태 변경
   - ✓ 회원 조회
   - ✗ 회원 수정
   - ✓ 상품 조회
   - ✗ 상품 등록/수정
   - ✗ 매출 통계
6. "서브관리자 등록" 버튼 클릭
7. **검증**:
   - 서브관리자가 성공적으로 생성되는지 확인
   - g5_auth 테이블에 권한이 올바르게 저장되는지 확인

### 2. 서브관리자 로그인 및 메뉴 접근

#### 2.1 로그인 및 메뉴 표시
1. 서브관리자(b_staff_sub_01)로 로그인
2. **검증**:
   - 로그인이 성공하는지 확인
   - 권한이 있는 메뉴만 표시되는지 확인
   - 프랜차이즈 관리 메뉴가 표시되지 않는지 확인
   - 상위 계층 관련 메뉴가 모두 숨김 처리되는지 확인

### 3. 주문 관리 권한 테스트

#### 3.1 주문 조회 권한 (허용됨)
1. [주문 관리] > "주문 목록" 메뉴 클릭
2. **검증**:
   - 주문 목록 페이지에 접근 가능한지 확인
   - 자신이 속한 지점(b_test_01)의 주문만 표시되는지 확인
   - 다른 지점의 주문은 표시되지 않는지 확인
   - 필터링 옵션에서 지점 선택이 불가능한지 확인

#### 3.2 주문 상태 변경 권한 (허용됨)
1. 주문 상세 페이지 접속
2. 주문 상태를 "주문확인" → "배송준비중"으로 변경
3. **검증**:
   - 주문 상태 변경이 가능한지 확인
   - 변경 이력이 기록되는지 확인
   - 변경자 정보가 올바르게 표시되는지 확인

### 4. 회원 관리 권한 테스트

#### 4.1 회원 조회 권한 (허용됨)
1. [회원 관리] > "회원 목록" 메뉴 클릭
2. **검증**:
   - 회원 목록 페이지에 접근 가능한지 확인
   - 자신이 속한 지점에서 주문한 회원만 표시되는지 확인
   - 회원 상세 정보 조회가 가능한지 확인

#### 4.2 회원 수정 권한 (차단됨)
1. 회원 상세 페이지에서 "수정" 버튼 확인
2. **검증**:
   - 수정 버튼이 비활성화되어 있거나 숨김 처리되는지 확인
   - 직접 수정 요청 시 권한 오류가 발생하는지 확인

### 5. 상품 관리 권한 테스트

#### 5.1 상품 조회 권한 (허용됨)
1. [상품 관리] > "상품 목록" 메뉴 클릭
2. **검증**:
   - 상품 목록 페이지에 접근 가능한지 확인
   - 자신의 지점에서 판매 가능한 상품만 표시되는지 확인
   - 상품 상세 정보 조회가 가능한지 확인

#### 5.2 상품 등록/수정 권한 (차단됨)
1. 상품 등록 버튼 확인
2. **검증**:
   - 상품 등록 버튼이 표시되지 않는지 확인
   - 상품 수정 버튼이 비활성화되어 있는지 확인

### 6. 프랜차이즈 관리 접근 테스트

#### 6.1 지점 관리 접근 (차단됨)
1. 프랜차이즈 관리 메뉴 접근 시도
2. **검증**:
   - 프랜차이즈 관리 메뉴가 표시되지 않는지 확인
   - 지점 서브관리자는 조직 구조를 변경할 수 없음을 확인

#### 6.2 자신의 지점 정보 수정 (차단됨)
1. 자신이 속한 지점 정보 수정 시도
2. **검증**:
   - 지점 정보 수정 권한이 없음을 확인
   - 조직 정보는 최고관리자만 수정 가능함을 확인

### 7. 매출 통계 접근 테스트

#### 7.1 매출 통계 조회 (차단됨)
1. 매출 통계 메뉴 접근 시도
2. **검증**:
   - 매출 통계 메뉴가 표시되지 않는지 확인
   - 민감한 재무 정보에는 접근할 수 없음을 확인

### 8. 데이터 범위 제한 테스트

#### 8.1 날짜 범위 제한
1. 주문 목록에서 날짜 필터 적용
2. **검증**:
   - 모든 기간의 데이터를 조회할 수 있는지 확인
   - 또는 특정 기간으로 제한되는지 확인

#### 8.2 검색 범위 제한
1. 회원 검색 기능 사용
2. **검증**:
   - 자신의 지점 회원만 검색되는지 확인
   - 전체 회원 검색이 차단되는지 확인

### 9. 동시 로그인 테스트

#### 9.1 다중 디바이스 로그인
1. 서로 다른 브라우저/디바이스에서 동시 로그인
2. **검증**:
   - 동시 로그인이 허용되는지 확인
   - 세션 관리가 올바르게 작동하는지 확인

## 예상 결과

지점 서브관리자는:
- 실무에 필요한 최소한의 권한만 보유
- 자신이 속한 지점의 데이터만 접근 가능
- 조직 구조 변경 권한 없음
- 주문/회원/상품 조회 및 제한적 처리만 가능
- 재무 정보 등 민감한 데이터 접근 불가

## 테스트 데이터
```
계정 정보:
- 지점 최고관리자: b_test_01 / b_test_01
- 지점 서브관리자: b_staff_sub_01 / b_staff_sub_01

권한 설정 (g5_auth):
- au_menu: 주문관리, 회원관리, 상품관리
- au_auth: r (읽기), w (일부 쓰기 - 주문 상태 변경만)

계층 구조:
- 총판: d_test_01
  └─ 대리점: a_test_01
      └─ 지점: b_test_01
```

## 주의사항
- 지점 서브관리자는 가장 제한적인 권한을 가짐
- 실무 처리에 필요한 최소한의 권한만 부여
- 조직 관리 기능은 완전히 차단됨
- 민감한 정보(재무, 개인정보 등)에 대한 접근 제한