# 총판 서브관리자 권한 테스트 시나리오

## 테스트 개요
- **테스트 대상**: 총판 서브관리자
- **테스트 목적**: 총판 서브관리자의 제한된 권한 동작 검증
- **상위 계층**: 특정 총판 소속

## 사전 조건
- 총판 최고관리자 계정이 생성되어 있어야 함 (예: d_test_01)
- 총판 서브관리자 계정이 생성되어 있어야 함 (예: d_sales_sub_01)
- g5_auth 테이블에 서브관리자 권한이 설정되어 있어야 함

## 테스트 시나리오

### 1. 서브관리자 계정 생성 및 권한 부여

#### 1.1 총판 최고관리자로 서브관리자 생성
1. 총판 최고관리자(d_test_01)로 로그인
2. [관리자 관리] > "서브관리자 관리" 메뉴 접속
3. "+ 서브관리자 등록" 버튼 클릭
4. 서브관리자 정보 입력:
   - 관리자 ID: `d_sales_sub_01`
   - 비밀번호: `d_sales_sub_01`
   - 이름: `총판영업담당`
   - 이메일: `d_sales_sub_01@gmail.com`
5. 권한 설정:
   - ✓ 대리점 조회
   - ✓ 대리점 등록
   - ✗ 대리점 수정
   - ✗ 대리점 삭제
   - ✓ 지점 조회
   - ✗ 지점 등록/수정/삭제
6. "서브관리자 등록" 버튼 클릭
7. **검증**:
   - 서브관리자가 성공적으로 생성되는지 확인
   - g5_auth 테이블에 권한이 올바르게 저장되는지 확인

### 2. 서브관리자 로그인 및 메뉴 접근

#### 2.1 로그인 및 메뉴 표시
1. 서브관리자(d_sales_sub_01)로 로그인
2. **검증**:
   - 로그인이 성공하는지 확인
   - 관리자 메인 페이지가 표시되는지 확인
   - 권한이 있는 메뉴만 표시되는지 확인
   - 권한이 없는 메뉴는 숨김 처리되는지 확인

### 3. 대리점 관리 권한 테스트

#### 3.1 대리점 조회 권한 (허용됨)
1. [프랜차이즈 관리] > "대리점관리" 메뉴 클릭
2. **검증**:
   - 대리점 목록 페이지에 접근 가능한지 확인
   - 자신이 속한 총판(d_test_01) 소속 대리점만 표시되는지 확인
   - 다른 총판 소속 대리점은 표시되지 않는지 확인

#### 3.2 대리점 등록 권한 (허용됨)
1. "+ 대리점 등록" 버튼 클릭
2. 대리점 정보 입력:
   - 대리점 ID: `a_sub_test_01`
   - 비밀번호: `a_sub_test_01`
   - 대리점명: `서브테스트대리점`
   - 회사명: `서브테스트대리점`
3. "확인" 버튼 클릭
4. **검증**:
   - 대리점이 성공적으로 등록되는지 확인
   - 등록된 대리점의 소속 총판이 자동으로 d_test_01로 설정되는지 확인
   - 목록에서 새로 등록된 대리점이 표시되는지 확인

#### 3.3 대리점 수정 권한 (차단됨)
1. 대리점 목록에서 "수정" 버튼 클릭 시도
2. **검증**:
   - 수정 버튼이 비활성화되어 있거나 숨김 처리되는지 확인
   - 직접 URL 접근 시 권한 오류 메시지가 표시되는지 확인

#### 3.4 대리점 삭제 권한 (차단됨)
1. 대리점 목록에서 "삭제" 버튼 클릭 시도
2. **검증**:
   - 삭제 버튼이 비활성화되어 있거나 숨김 처리되는지 확인
   - 직접 삭제 요청 시 권한 오류가 발생하는지 확인

### 4. 지점 관리 권한 테스트

#### 4.1 지점 조회 권한 (허용됨)
1. [프랜차이즈 관리] > "지점관리" 메뉴 클릭
2. **검증**:
   - 지점 목록 페이지에 접근 가능한지 확인
   - 자신이 속한 총판(d_test_01) 하위의 모든 지점이 표시되는지 확인
   - 다른 총판 하위 지점은 표시되지 않는지 확인

#### 4.2 지점 등록 권한 (차단됨)
1. "+ 지점 등록" 버튼 확인
2. **검증**:
   - 지점 등록 버튼이 비활성화되어 있거나 숨김 처리되는지 확인
   - 직접 URL 접근 시 권한 오류 메시지가 표시되는지 확인

### 5. 상위 계층 접근 테스트

#### 5.1 본사 메뉴 접근 (차단됨)
1. 본사 관련 메뉴 접근 시도
2. **검증**:
   - 본사 관련 메뉴가 표시되지 않는지 확인
   - URL 직접 접근 시 권한 오류가 발생하는지 확인

#### 5.2 총판 정보 수정 (차단됨)
1. 자신이 속한 총판 정보 수정 시도
2. **검증**:
   - 총판 정보 수정 권한이 없음을 확인
   - 서브관리자는 상위 계층 정보를 변경할 수 없음을 확인

### 6. 동일 계층 타 조직 접근 테스트

#### 6.1 다른 총판 데이터 접근 (차단됨)
1. URL 조작을 통해 다른 총판 데이터 접근 시도
2. **검증**:
   - 접근이 차단되는지 확인
   - 적절한 권한 오류 메시지가 표시되는지 확인

### 7. 권한 변경 실시간 반영 테스트

#### 7.1 권한 축소 테스트
1. 총판 최고관리자가 서브관리자의 대리점 등록 권한 제거
2. 서브관리자가 대리점 등록 시도
3. **검증**:
   - 권한 변경이 즉시 반영되는지 확인
   - 대리점 등록이 차단되는지 확인

#### 7.2 권한 확대 테스트
1. 총판 최고관리자가 서브관리자에게 대리점 수정 권한 부여
2. 서브관리자가 대리점 수정 시도
3. **검증**:
   - 권한 변경이 즉시 반영되는지 확인
   - 대리점 수정이 가능해지는지 확인

## 예상 결과

총판 서브관리자는:
- 부여받은 권한 범위 내에서만 기능 사용 가능
- 자신이 속한 총판과 그 하위 계층만 접근 가능
- 상위 계층(본사) 및 동일 계층 타 조직 접근 불가
- 권한 변경사항이 실시간으로 반영됨

## 테스트 데이터
```
계정 정보:
- 총판 최고관리자: d_test_01 / d_test_01
- 총판 서브관리자: d_sales_sub_01 / d_sales_sub_01

권한 설정 (g5_auth):
- au_menu: 대리점관리, 지점관리
- au_auth: r (읽기), w (쓰기 - 대리점 등록만)
```

## 주의사항
- 서브관리자 권한은 g5_auth 테이블에서 관리됨
- 메뉴 접근과 기능 권한이 분리되어 있음
- 계층 구조 권한과 기능별 권한이 AND 조건으로 적용됨